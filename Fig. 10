%%% Calculations for Fig.10 (optimized parameters of different face velocity and target removal efficiency) %%%
clc; clear all;
format long

cc = 1 + 65*10^(-9)/(1*10^(-6)) * (2.514 + 0.8*exp(-0.55*1*10^(-6)/(65*10^(-9))))
c1 = 1.364/pi * 1.8*10^(-5) * (2*65*10^(-9))^(-0.556)
c2 = 6.8*10^17/(1.3*10^(-5))^3.182*(cc*2000*10^(-12)/18/(1.8*10^(-5)))^(-3.698)*4/pi
c3 = 0.0537*(1.3*10^(-5))^0.406*(cc*2000*10^(-12)/18/(1.8*10^(-5)))^0.129*4/pi

gamma = 1.70*10^(-6)
c4 = gamma / 1130 / 0.06^2 / 3600

eta = [0.99 	0.95 	0.90 	0.85 	0.80 	0.99 	0.95 	0.90 	0.85 	0.80 	0.99 	0.95 	0.90 	0.85 	0.80 	0.99 	0.95 	0.90 	0.85 	0.80 	0.99 	0.95 	0.90 	0.85 	0.80 ]; 
U0 = [0.06	0.06	0.06	0.06	0.06	0.08	0.08	0.08	0.08	0.08	0.1	0.1	0.1	0.1	0.1	0.12	0.12	0.12	0.12	0.12	0.14	0.14	0.14	0.14	0.14    ];
[m, n] = size(eta)
P = zeros(1,n); C = zeros(1,n); f1 = zeros(1,n); alpha = zeros(1,n); df = zeros(1,n); L = zeros(1,n); ts = zeros(1,n);

for i = 1:n
Cn = 0.18:0.001:0.27;
% mimP, and corresponding Cn
minP = @(Cn) c1*log(1-eta(i))/(c2*(c4*Cn/((0.623-0.285./(1+(Cn./0.262).^23.2)).*10.^(-6)./3600))^13.512 * (0.124+(6.97.*10.^(-8)-0.124)./(1+(Cn./0.897)^11.2))^7.324 * U0(i)^(-1.516) - c3*(c4*Cn/((0.623-0.285./(1+(Cn./0.262).^23.2)).*10.^(-6)./3600))^1.481 * (0.124+(6.97.*10.^(-8)-0.124)./(1+(Cn./0.897)^11.2))^(-0.091) * U0(i)^(-1.277))
[Cn,minP] = fminbnd(minP,0.18,0.27)
P(i) = minP; C(i) = Cn;

% f(L/t) = f1
f1(i) = (0.623 + (0.333-0.623)/(1 + (Cn/0.262)^23.2))*10^(-6)

% alpha (packing density)
alpha(i) = gamma * Cn/(1130 * 0.06^2 * f1(i))

% df (fiber diameter)
df(i) = 0.124+(6.97*10^(-8)-0.124)/(1 + (Cn/0.897)^11.2)

% L (filter thickness)
L(i) = (1-alpha(i)) * log(1-eta(i))/(c2 * alpha(i)^13.670 * df(i)^5.880 * U0(i)^(-0.516)-c3 * alpha(i)^1.639 * df(i)^(-1.535) * U0(i)^(-0.277))

% ts (electrospinning time)
ts(i) = L(i)/f1(i)
end

format long g
A = [U0' eta' P' C'*100 alpha' df'*10^9 L'*10^6 ts']
